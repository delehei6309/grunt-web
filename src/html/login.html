<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport"
          content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <title>登录</title>
    <link rel="stylesheet" type="text/css" href="/public/css/base.css?v=0.0.0">
    <link rel="stylesheet" type="text/css" href="/public/css/style.css?v=0.0.0">
    <link rel="stylesheet" href="/public/css/dialog.css" />
</head>
<body>
    <div id="app" class="login">
    	<div class="tabs">
    		<ul flex="box:mean" id="tabs-items">
    			<li class="selected">短信登录</li>
    			<li>账号登录</li>
    		</ul>
    	</div>
    	<div class="content">
    		<div flex class="swipe">
    			<div class="mobile form-wrap">
	    			<label for="number" class="ui-border lable-number" flex="cross:center">
	    				<span class="span-left">+86</span>
	    				<span class="span-input">
	    					<input type="text" id="number" maxlength="11" placeholder="请输入手机号码">
	    				</span>
	    			</label>
	    			<label for="captcha" flex="main:justify cross:center">
	    				<span class="ui-border span-captcha" flex="cross:center">
	    					<input type="text" id="captcha" maxlength="6" placeholder="请输入验证码">
	    				</span>
	    				<span>
	    					<button class="captcha-btn">获取验证码</button>
	    				</span>
	    			</label>
	    		</div>
	    		<div class="account form-wrap">
	    			<label for="account" class="ui-border lable-number" flex="cross:center">
	    				<span class="span-left">账号</span>
	    				<span class="span-input">
	    					<input type="text" id="account" maxlength="20" placeholder="请使用听戏账号登录">
	    				</span>
	    			</label>
	    			<label for="psw" class="ui-border lable-number" flex="cross:center">
	    				<span class="span-left">密码</span>
	    				<span class="span-input">
	    					<input type="text" id="psw" maxlength="16" placeholder="请输入密码">
	    				</span>
	    			</label>
	    		</div>
    		</div>
    	</div>
    	<div class="button">
    		<button id="submit">登录</button>
    	</div>
    </div>
    <script type="text/javascript" src="http://resource.hualumedia.com/common/js/zepto.min.js"></script>
    <script type="text/javascript" src="/public/js/fun.js"></script>
    <script type="text/javascript" src="/public/tools/dialog.min.js"></script>
	<script type="text/javascript">
	    $(function(){
	        //tab切换
	        var $tab = $('#tabs-items').find('li');
	        var $swipe = $('.swipe');
	        $tab.tap(function(){
				$tab.removeClass('selected');
				$(this).addClass('selected');
				if($(this).index() == 1){
					//账号登录
					$swipe.addClass('type-account');
					return false;
				}
				$swipe.removeClass('type-account');
	        });
	        //下发验证码
	        var $captchaBtn = $('.captcha-btn');
	        var captchaLoading = false;
	        var number = '';//手机号存储
	        $captchaBtn.tap(function(){
	        	if(captchaLoading){
	        		return false;
	        	}
	        	number = $('#number').val();
	        	if(!checkPhone(number)){
					acfun('手机号输入有误')
					return false;
				}
				sendCode(60);
	        });
	        function sendCode(time){
                captchaLoading = true;
                $captchaBtn.text(time+'s');
                if(time > 0){
                    time -- ;
                    timer = setTimeout(function() {
                        sendCode(time)
                    },1000);
                }else{
                	$captchaBtn.text('重新发送');
                    captchaLoading = false;
                }
                
            }

	        var submiting = false;//
	        //登录
	        $('#submit').tap(function(){
	        	if(submiting){
					return false;
				}
	        	if($swipe.hasClass('type-account')){
	        		//账号登录
	        		var account = $('#account').val();//账号
	        		if(!$.trim(account)){
						acfun('请输入账号')
						return false;
					}
					var psw = $('#psw').val();//密码
					if(!$.trim(psw)){
						acfun('请输入密码')
						return false;
					}
	        		// 提交
	        		var dialog1 = $(document).dialog({
		        		type:'toast',
		        		infoIcon:'/public/images/icon/loading.gif',
				        infoText: '登录中',
				    });
	        	}else{
	        		//短信登录
	        		number = $('#number').val();
					if(!checkPhone(number)){
						// acfun('手机号输入有误')
						return false;
					}
					var captcha = $('#captcha').val();
					if(!$.trim(captcha)){
						acfun('请输入验证码')
						return false;
					}
					//提交
					//.....
	        	}
	        });
			//手机验证
	        function checkPhone(phone){
			    var regPhone = /^(0|86|17951)?(1)[0-9]{10}$/;
			    if(regPhone.test(phone)){
			        return true;
			    }else{
			        return false;
			    }
			}
	    });
	</script>
</body>
</html>